(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{384:function(t,s,n){"use strict";n.r(s);var a=n(42),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h3",{attrs:{id:"登录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#登录"}},[t._v("#")]),t._v(" 登录")]),t._v(" "),n("ul",[n("li",[t._v("登录校验&登录信息存储")])]),t._v(" "),n("h3",{attrs:{id:"_1、cookie-session"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、cookie-session"}},[t._v("#")]),t._v(" 1、cookie & session")]),t._v(" "),n("h4",{attrs:{id:"_1-1、cookie"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、cookie"}},[t._v("#")]),t._v(" 1.1、cookie")]),t._v(" "),n("p",[n("strong",[t._v("cookie")]),t._v("存储在"),n("strong",[t._v("浏览器的键值对")]),t._v("（key=value）字符串。")]),t._v(" "),n("p",[t._v("有 5 kb 的大小限制，跨域不共享。")]),t._v(" "),n("p",[t._v("当每次发送请求时，将cookie发送给服务器。")]),t._v(" "),n("p",[t._v("在浏览器查看cookie 浏览器输入以下命令或值在network面板中找到对应的cookie即可。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie\n")])])]),n("p",[t._v("服务端操作 cookie (nodejs操作)")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取")]),t._v("\nreq"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 操作 cookie")]),t._v("\nres"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Set-Cookie'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("username=")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("username"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("; path=/; httpOnly;  expires=")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCookieEexpries")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// path=/： 告诉浏览器cookie的使用范围时 / 路由")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// httpOnly： 限制用户（客户端）更改cookie")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// expires=${getCookieEexpries()}:设置过期时间")]),t._v("\n")])])]),n("h4",{attrs:{id:"_1-2、session"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、session"}},[t._v("#")]),t._v(" 1.2、session")]),t._v(" "),n("p",[t._v("解决什么问题？")]),t._v(" "),n("p",[t._v("cookie发送个客户端容易暴露个人信息，所以给客户端的是一个不重复的随机数，在服务端存着（session中）这个随机数对应用户的名字，这样可以验证用户的信息了。")]),t._v(" "),n("p",[t._v("session存在什么问题？")]),t._v(" "),n("p",[t._v("问题1：session存放在服务器内存中的，所以访问量过大，session也一起扩大，导致内存暴增。")]),t._v(" "),n("p",[t._v("问题2：线上环境在多线程 session 无法共享session。")]),t._v(" "),n("p",[t._v("解决方案："),n("strong",[t._v("redis")])]),t._v(" "),n("h3",{attrs:{id:"_2、session-写入-redis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、session-写入-redis"}},[t._v("#")]),t._v(" 2、session 写入 redis")]),t._v(" "),n("p",[t._v("redis 是内存数据库")]),t._v(" "),n("p",[n("strong",[t._v("redis")]),t._v("是常用的缓存数据库，数据存储在内存中。")]),t._v(" "),n("p",[t._v("redis 是单独开辟一个进程，其他进程都可以访问，")]),t._v(" "),n("p",[t._v("安装：")]),t._v(" "),n("p",[t._v("下载完成后进入redis目录")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" D:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Software2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("redis\n\n\n// 启动\nredis-server.exe redis.windows.conf\n")])])]),n("p",[t._v("新建一个cmd窗口 之前串口不要关，切换到 redis目录")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("// 开去一个服务\nredis-cli.exe -h "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1 -p "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6379")]),t._v("\n\n// 设置\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" name tom\n\n// 读取\nget name\n\n// 获取所有redis\nkeys *\n\n// 删除\ndel name\n")])])]),n("h4",{attrs:{id:"_2-1、node-连接-redis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、node-连接-redis"}},[t._v("#")]),t._v(" 2.1、node 连接 redis")]),t._v(" "),n("p",[t._v("安装")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("npm i redis --save\n")])])]),n("p",[t._v("使用")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" redis "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'redis'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建客户端 启动服务的端口 访问地址 ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" redisClient "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" redis"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createClient")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6379")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'127.0.0.1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 发生错误处理")]),t._v("\nredisClient"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用 第三个参数打印 ok")]),t._v("\nredisClient"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myname'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Tom'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("redis"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("print"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nredisClient"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myname'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("val")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("val"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 退出")]),t._v("\n\tredisClient"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("quit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("h3",{attrs:{id:"_3、nginx-反向代理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、nginx-反向代理"}},[t._v("#")]),t._v(" 3、nginx 反向代理")]),t._v(" "),n("h4",{attrs:{id:"_3-1、nginx-是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1、nginx-是什么"}},[t._v("#")]),t._v(" 3.1、nginx 是什么")]),t._v(" "),n("p",[t._v("nginx是高性能 "),n("strong",[t._v("web 服务器")]),t._v("，开源并且免费。")]),t._v(" "),n("p",[t._v("nginx 有以下用处")]),t._v(" "),n("ul",[n("li",[t._v("静态服务")]),t._v(" "),n("li",[t._v("负载均衡")]),t._v(" "),n("li",[t._v("反向代理")])]),t._v(" "),n("p",[t._v("这里只介绍"),n("strong",[t._v("反向代理")]),t._v("。")]),t._v(" "),n("p",[t._v("前后端分离的项目中，我们需要开启两个服务，所以存在"),n("strong",[t._v("跨域问题")])]),t._v(" "),n("p",[t._v("这里 nginx 做的就是，我们启动两个服务，比如我们项目静态页面在 5500 端口上运行的，后端运行在 8088 端口上，当我们访问想获取后端数据是存在跨域问题。")]),t._v(" "),n("p",[t._v("我们安装 nginx 后把 nginx 启动在默认的80端口上，nginx 的作用是 当用户访问路径 以 / 开头时，代理到5500 端口上，当用户访问 /api/开头是代理到 8088 端口上。")]),t._v(" "),n("p",[t._v("这样可以解决跨域问题。")]),t._v(" "),n("h4",{attrs:{id:"_3-2、安装-配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2、安装-配置"}},[t._v("#")]),t._v(" 3.2、安装 & 配置")]),t._v(" "),n("p",[t._v("打开下载的目录找到 "),n("code",[t._v("nginx/fon/nginx.conf")]),t._v(" 文件")]),t._v(" "),n("div",{staticClass:"language-conf extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// 需要注释\n#    location / {\n#        root   html;\n#        index  index.html index.htm;\n#    }\n#}\n")])])]),n("p",[t._v("自己添加配置nginx/fon/nginx.conf")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("\n# / 开头的请求代理到http://localhost:5500;\nlocation / {\n\tproxy_pass: http://localhost:5500;\n}\n \n# /api/ 开头的请求代理到http://localhost:8088;\nlocation /api/ {\n\tproxy_pass: http://localhost:8088;\n\tproxy_set_header Host $host;\n}\n")])])]),n("p",[t._v("在根目录打开 cmd 输入 "),n("code",[t._v("nginx -t")]),t._v(" 测试，输出以下内容说明安装成功。")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("D:\\Software2\\nginx>nginx -t\nnginx: the configuration file D:\\Software2\\nginx/conf/nginx.conf syntax is ok\nnginx: configuration file D:\\Software2\\nginx/conf/nginx.conf test is successful\n")])])]),n("p",[t._v("启动：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("nginx\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);